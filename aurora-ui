-- Aurora UI - Premium Animated Library
local Aurora = {}
Aurora.__index = Aurora

-- Services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")

-- Animation Presets
local TweenInfo = {
    Smooth = TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.Out),
    Bounce = TweenInfo.new(0.6, Enum.EasingStyle.Bounce, Enum.EasingDirection.Out),
    Elastic = TweenInfo.new(0.8, Enum.EasingStyle.Elastic, Enum.EasingDirection.Out),
    Quick = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
}

function Aurora:CreateMain(options)
    local self = setmetatable({}, Aurora)
    
    self.Config = {
        Name = options.Name or "Aurora",
        Theme = options.Theme or {
            Main = Color3.fromRGB(20, 20, 30),
            Secondary = Color3.fromRGB(30, 30, 45),
            Accent = Color3.fromRGB(138, 43, 226),
            Text = Color3.fromRGB(240, 240, 240),
            TextSecondary = Color3.fromRGB(180, 180, 200),
            LightAccent = Color3.fromRGB(158, 73, 246)
        },
        ToggleKey = options.ToggleKey or Enum.KeyCode.RightShift,
        OpenSound = options.OpenSound or "rbxassetid://9046389332",
        CloseSound = options.CloseSound or "rbxassetid://9046389332"
    }
    
    self.Elements = {}
    self.Visible = false
    self.Dragging = false
    self.DragStart = nil
    self.DragStartPosition = nil
    
    self:CreateUI()
    self:SetupInput()
    
    return self
end

function Aurora:CreateUI()
    -- Main GUI Container
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "AuroraUI"
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    self.ScreenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
    
    -- Open Button (Floating)
    self.OpenButton = self:CreateOpenButton()
    
    -- Main Window (Initially Hidden)
    self.MainWindow = self:CreateMainWindow()
    
    -- Make window draggable
    self:MakeDraggable(self.TopBar)
end

function Aurora:CreateOpenButton()
    local button = Instance.new("ImageButton")
    button.Name = "OpenButton"
    button.Size = UDim2.new(0, 60, 0, 60)
    button.Position = UDim2.new(0, 20, 0.5, -30)
    button.BackgroundColor3 = self.Config.Theme.Accent
    button.Image = "rbxassetid://10734996820" -- Modern icon
    button.ScaleType = Enum.ScaleType.Fit
    button.Visible = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(1, 0)
    corner.Parent = button
    
    local glow = Instance.new("ImageLabel")
    glow.Name = "Glow"
    glow.Size = UDim2.new(1.2, 0, 1.2, 0)
    glow.Position = UDim2.new(-0.1, 0, -0.1, 0)
    glow.BackgroundTransparency = 1
    glow.Image = "rbxassetid://10734996820"
    glow.ImageColor3 = self.Config.Theme.Accent
    glow.ImageTransparency = 0.7
    glow.ScaleType = Enum.ScaleType.Fit
    glow.Parent = button
    
    -- Pulse animation
    self:CreatePulseAnimation(glow)
    
    button.MouseButton1Click:Connect(function()
        self:Toggle()
    end)
    
    button.Parent = self.ScreenGui
    return button
end

function Aurora:CreatePulseAnimation(element)
    local pulse = RunService.Heartbeat:Connect(function()
        local sin = math.sin(tick() * 3)
        element.ImageTransparency = 0.7 + math.abs(sin) * 0.2
    end)
end

function Aurora:CreateMainWindow()
    local window = Instance.new("Frame")
    window.Name = "MainWindow"
    window.Size = UDim2.new(0, 450, 0, 500)
    window.Position = UDim2.new(0.5, -225, 0.5, -250)
    window.BackgroundColor3 = self.Config.Theme.Main
    window.Visible = false
    window.ClipsDescendants = true
    
    -- Modern corner radius
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 16)
    corner.Parent = window
    
    -- Subtle shadow
    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.Size = UDim2.new(1, 20, 1, 20)
    shadow.Position = UDim2.new(0, -10, 0, -10)
    shadow.BackgroundTransparency = 1
    shadow.Image = "rbxassetid://5554237733"
    shadow.ImageColor3 = Color3.new(0, 0, 0)
    shadow.ImageTransparency = 0.8
    shadow.ScaleType = Enum.ScaleType.Slice
    shadow.SliceCenter = Rect.new(23, 23, 277, 277)
    shadow.Parent = window
    shadow.ZIndex = -1
    
    -- Top Bar
    self.TopBar = self:CreateTopBar()
    self.TopBar.Parent = window
    
    -- Tab Buttons
    self.TabContainer = self:CreateTabContainer()
    self.TabContainer.Parent = window
    
    -- Content Area
    self.ContentFrame = self:CreateContentFrame()
    self.ContentFrame.Parent = window
    
    window.Parent = self.ScreenGui
    return window
end

function Aurora:CreateTopBar()
    local topBar = Instance.new("Frame")
    topBar.Name = "TopBar"
    topBar.Size = UDim2.new(1, 0, 0, 50)
    topBar.BackgroundColor3 = self.Config.Theme.Secondary
    topBar.BorderSizePixel = 0
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 16)
    corner.Parent = topBar
    
    -- Title
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(0.5, 0, 1, 0)
    title.Position = UDim2.new(0, 20, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "AURORA UI"
    title.TextColor3 = self.Config.Theme.Text
    title.Font = Enum.Font.GothamBold
    title.TextSize = 18
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = topBar
    
    -- Close Button
    local closeBtn = Instance.new("ImageButton")
    closeBtn.Name = "CloseButton"
    closeBtn.Size = UDim2.new(0, 30, 0, 30)
    closeBtn.Position = UDim2.new(1, -40, 0.5, -15)
    closeBtn.BackgroundColor3 = self.Config.Theme.Secondary
    closeBtn.Image = "rbxassetid://10734994956" -- X icon
    closeBtn.ScaleType = Enum.ScaleType.Fit
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(1, 0)
    btnCorner.Parent = closeBtn
    
    closeBtn.MouseButton1Click:Connect(function()
        self:Toggle()
    end)
    
    closeBtn.Parent = topBar
    
    return topBar
end

function Aurora:CreateTabContainer()
    local container = Instance.new("Frame")
    container.Name = "TabContainer"
    container.Size = UDim2.new(1, -40, 0, 40)
    container.Position = UDim2.new(0, 20, 0, 60)
    container.BackgroundTransparency = 1
    
    local layout = Instance.new("UIListLayout")
    layout.FillDirection = Enum.FillDirection.Horizontal
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Left
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, 8)
    layout.Parent = container
    
    return container
end

function Aurora:CreateContentFrame()
    local content = Instance.new("Frame")
    content.Name = "Content"
    content.Size = UDim2.new(1, -40, 1, -120)
    content.Position = UDim2.new(0, 20, 0, 120)
    content.BackgroundTransparency = 1
    content.ClipsDescendants = true
    
    return content
end

function Aurora:MakeDraggable(frame)
    local dragging = false
    local dragInput, dragStart, startPos

    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = self.MainWindow.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            self.MainWindow.Position = UDim2.new(
                startPos.X.Scale, 
                startPos.X.Offset + delta.X,
                startPos.Y.Scale, 
                startPos.Y.Offset + delta.Y
            )
        end
    end)
end

function Aurora:CreateTab(name, icon)
    local tab = {
        Name = name,
        Content = Instance.new("ScrollingFrame")
    }
    
    -- Tab Button
    local tabButton = Instance.new("TextButton")
    tabButton.Name = name .. "Tab"
    tabButton.Size = UDim2.new(0, 100, 1, 0)
    tabButton.BackgroundColor3 = self.Config.Theme.Secondary
    tabButton.Text = name
    tabButton.TextColor3 = self.Config.Theme.TextSecondary
    tabButton.Font = Enum.Font.GothamSemibold
    tabButton.TextSize = 14
    tabButton.AutoButtonColor = false
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = tabButton
    
    -- Tab Content
    tab.Content.Size = UDim2.new(1, 0, 1, 0)
    tab.Content.BackgroundTransparency = 1
    tab.Content.BorderSizePixel = 0
    tab.Content.ScrollBarThickness = 3
    tab.Content.ScrollBarImageColor3 = self.Config.Theme.Accent
    tab.Content.Visible = false
    tab.Content.Parent = self.ContentFrame
    
    local layout = Instance.new("UIListLayout")
    layout.Parent = tab.Content
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, 10)
    
    local padding = Instance.new("UIPadding")
    padding.Parent = tab.Content
    padding.PaddingLeft = UDim.new(0, 5)
    padding.PaddingTop = UDim.new(0, 5)
    
    -- Click Event
    tabButton.MouseButton1Click:Connect(function()
        self:SwitchTab(tab)
    end)
    
    -- Hover Effects
    tabButton.MouseEnter:Connect(function()
        if not tab.Active then
            TweenService:Create(tabButton, TweenInfo.Smooth, {
                BackgroundColor3 = self.Config.Theme.LightAccent,
                TextColor3 = self.Config.Theme.Text
            }):Play()
        end
    end)
    
    tabButton.MouseLeave:Connect(function()
        if not tab.Active then
            TweenService:Create(tabButton, TweenInfo.Smooth, {
                BackgroundColor3 = self.Config.Theme.Secondary,
                TextColor3 = self.Config.Theme.TextSecondary
            }):Play()
        end
    end)
    
    tabButton.Parent = self.TabContainer
    tab.Button = tabButton
    
    table.insert(self.Elements, tab)
    
    if #self.Elements == 1 then
        self:SwitchTab(tab)
    end
    
    return tab
end

function Aurora:SwitchTab(tab)
    for _, existingTab in pairs(self.Elements) do
        existingTab.Content.Visible = false
        if existingTab.Button then
            TweenService:Create(existingTab.Button, TweenInfo.Smooth, {
                BackgroundColor3 = self.Config.Theme.Secondary,
                TextColor3 = self.Config.Theme.TextSecondary
            }):Play()
        end
        existingTab.Active = false
    end
    
    tab.Content.Visible = true
    TweenService:Create(tab.Button, TweenInfo.Smooth, {
        BackgroundColor3 = self.Config.Theme.Accent,
        TextColor3 = self.Config.Theme.Text
    }):Play()
    tab.Active = true
end

function Aurora:CreateButton(options)
    local button = Instance.new("TextButton")
    button.Name = "Button"
    button.Size = UDim2.new(1, -10, 0, 45)
    button.BackgroundColor3 = self.Config.Theme.Secondary
    button.Text = options.text or "Button"
    button.TextColor3 = self.Config.Theme.Text
    button.Font = Enum.Font.GothamSemibold
    button.TextSize = 14
    button.AutoButtonColor = false
    button.Parent = options.parent.Content
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = button
    
    -- Hover Effects
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.Smooth, {
            BackgroundColor3 = self.Config.Theme.LightAccent,
            Size = UDim2.new(1, -5, 0, 45)
        }):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.Smooth, {
            BackgroundColor3 = self.Config.Theme.Secondary,
            Size = UDim2.new(1, -10, 0, 45)
        }):Play()
    end)
    
    -- Click Animation
    if options.callback then
        button.MouseButton1Click:Connect(function()
            TweenService:Create(button, TweenInfo.Quick, {
                BackgroundColor3 = self.Config.Theme.Accent,
                TextColor3 = Color3.new(1, 1, 1)
            }):Play()
            
            task.wait(0.1)
            
            TweenService:Create(button, TweenInfo.Smooth, {
                BackgroundColor3 = self.Config.Theme.LightAccent,
                TextColor3 = self.Config.Theme.Text
            }):Play()
            
            options.callback()
        end)
    end
    
    return button
end

function Aurora:CreateToggle(options)
    local toggleFrame = Instance.new("Frame")
    toggleFrame.Name = "Toggle"
    toggleFrame.Size = UDim2.new(1, -10, 0, 40)
    toggleFrame.BackgroundTransparency = 1
    toggleFrame.Parent = options.parent.Content
    
    local label = Instance.new("TextLabel")
    label.Name = "Label"
    label.Size = UDim2.new(0.7, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = options.text or "Toggle"
    label.TextColor3 = self.Config.Theme.Text
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = toggleFrame
    
    local toggle = Instance.new("Frame")
    toggle.Name = "ToggleSwitch"
    toggle.Size = UDim2.new(0, 50, 0, 25)
    toggle.Position = UDim2.new(1, -50, 0.5, -12.5)
    toggle.BackgroundColor3 = self.Config.Theme.Secondary
    toggle.Parent = toggleFrame
    
    local toggleCorner = Instance.new("UICorner")
    toggleCorner.CornerRadius = UDim.new(1, 0)
    toggleCorner.Parent = toggle
    
    local toggleDot = Instance.new("Frame")
    toggleDot.Name = "ToggleDot"
    toggleDot.Size = UDim2.new(0, 19, 0, 19)
    toggleDot.Position = UDim2.new(0, 3, 0.5, -9.5)
    toggleDot.BackgroundColor3 = self.Config.Theme.Text
    toggleDot.Parent = toggle
    
    local dotCorner = Instance.new("UICorner")
    dotCorner.CornerRadius = UDim.new(1, 0)
    dotCorner.Parent = toggleDot
    
    local state = options.default or false
    
    local function updateToggle()
        if state then
            TweenService:Create(toggle, TweenInfo.Smooth, {
                BackgroundColor3 = self.Config.Theme.Accent
            }):Play()
            TweenService:Create(toggleDot, TweenInfo.Elastic, {
                Position = UDim2.new(0, 28, 0.5, -9.5)
            }):Play()
        else
            TweenService:Create(toggle, TweenInfo.Smooth, {
                BackgroundColor3 = self.Config.Theme.Secondary
            }):Play()
            TweenService:Create(toggleDot, TweenInfo.Elastic, {
                Position = UDim2.new(0, 3, 0.5, -9.5)
            }):Play()
        end
    end
    
    updateToggle()
    
    toggle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            state = not state
            updateToggle()
            if options.callback then
                options.callback(state)
            end
        end
    end)
    
    return toggleFrame
end

function Aurora:CreateSection(options)
    local section = Instance.new("Frame")
    section.Name = "Section"
    section.Size = UDim2.new(1, -10, 0, 50)
    section.BackgroundTransparency = 1
    section.Parent = options.parent.Content
    
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(1, 0, 1, 0)
    title.BackgroundTransparency = 1
    title.Text = options.text or "Section"
    title.TextColor3 = self.Config.Theme.Text
    title.Font = Enum.Font.GothamBold
    title.TextSize = 16
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = section
    
    local line = Instance.new("Frame")
    line.Name = "Line"
    line.Size = UDim2.new(1, 0, 0, 2)
    line.Position = UDim2.new(0, 0, 1, -2)
    line.BackgroundColor3 = self.Config.Theme.Accent
    line.BorderSizePixel = 0
    line.Parent = section
    
    return section
end

function Aurora:Toggle()
    self.Visible = not self.Visible
    
    if self.Visible then
        -- Show with animation
        self.MainWindow.Visible = true
        self.OpenButton.Visible = false
        
        TweenService:Create(self.MainWindow, TweenInfo.Elastic, {
            Size = UDim2.new(0, 450, 0, 500),
            Position = UDim2.new(0.5, -225, 0.5, -250)
        }):Play()
    else
        -- Hide with animation
        TweenService:Create(self.MainWindow, TweenInfo.Smooth, {
            Size = UDim2.new(0, 0, 0, 0),
            Position = UDim2.new(0.5, 0, 0.5, 0)
        }):Play()
        
        task.wait(0.3)
        self.MainWindow.Visible = false
        self.OpenButton.Visible = true
    end
end

function Aurora:SetupInput()
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if gameProcessed then return end
        
        if input.KeyCode == self.Config.ToggleKey then
            self:Toggle()
        end
    end)
end

return Aurora
